(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{46:function(e,t,a){e.exports=a(66)},51:function(e,t,a){},58:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),i=a.n(o),s=a(22),c=(a(51),a(8)),l=a(9),u=a(11),m=a(10),h=a(12),p=a(17),d=a(45),f=a(28),b=a(19),g=a(39),y=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={buildings:[],rooms:[]},a.selectBuilding=function(e){a.props.selectBuilding(e.target.value),a.refreshRooms(e.target.value)},a.selectRoom=function(e){a.props.selectRoom(e.target.value)},a.refreshRooms=function(e){var t=a.state.buildings;a.setState({rooms:t.find((function(t){return t.building===e})).rooms})},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:this.props.className},r.a.createElement(b.a,null,r.a.createElement(b.a.Group,{controlId:"form.building"},r.a.createElement(b.a.Label,null,"Building Code"),r.a.createElement(b.a.Control,{as:"select",onChange:this.selectBuilding,value:this.props.defaultBuilding},this.state.buildings.map((function(e){return r.a.createElement("option",{key:e.building,value:e.building},e.building)})))),r.a.createElement(b.a.Group,{controlId:"form.room"},r.a.createElement(b.a.Label,null,"Room Number"),r.a.createElement(b.a.Control,{as:"select",onChange:this.selectRoom,value:this.props.defaultRoom},r.a.createElement("option",null),this.state.rooms.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))))),r.a.createElement(g.a,{type:"submit",onClick:this.props.submit},this.props.buttonText||"Search"))}},{key:"componentDidMount",value:function(){this.callAPI()}},{key:"callAPI",value:function(){var e=this;fetch("/api/buildings").then((function(e){return e.json()})).then((function(t){e.setState({buildings:t},(function(){var t=e.props.defaultBuilding?e.props.defaultBuilding:e.state.buildings[0].building;e.props.selectBuilding(t),e.refreshRooms(t)}))})).catch((function(e){return e}))}}]),t}(n.Component),v=a(40),E=a(20),k=a(41),w=(a(55),a(56),a(57),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(o)))).calendarComponentRef=r.a.createRef(),a.state={times:[],events:[]},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(v.a,{plugins:[E.d,k.a],ref:this.calendarComponentRef,events:this.state.events,defaultView:"timeGridWeek",visibleRange:{start:"2020-06-01",end:"2020-06-05"},header:{left:"",right:""},weekends:!1,allDaySlot:!1,columnHeaderFormat:{weekday:"long"},minTime:"6:00:00",scrollTime:"8:00:00"})}},{key:"formatTimesOnWeekday",value:function(e){var t=this.state.times.filter((function(t){return t.weekdays.match(new RegExp(e))})).sort((function(e,t){return e.start_time>t.start_time?1:t.start_time>e.start_time?-1:0})).reduce((function(e,t){return 0!=e.length&&e[e.length-1].start_time==t.start_time||e.push(t),e}),[]).map((function(e){return Object.assign({},e)})),a="01";return"T(?!h)"==e&&(a="02"),"W"==e&&(a="03"),"Th"==e&&(a="04"),"F"==e&&(a="05"),t.map((function(e){return{start:new Date("2020-06-"+a+" "+e.start_time),end:new Date("2020-06-"+a+" "+e.end_time)}}))}},{key:"formatTimes",value:function(){var e=[];e=(e=(e=(e=(e=e.concat(this.formatTimesOnWeekday("M"))).concat(this.formatTimesOnWeekday("T(?!h)"))).concat(this.formatTimesOnWeekday("W"))).concat(this.formatTimesOnWeekday("Th"))).concat(this.formatTimesOnWeekday("F")),this.setState({events:e})}},{key:"displayCalendar",value:function(){var e=this,t=this.props.match.params,a=t.building,n=t.room;fetch("/api/building/".concat(a,"/").concat(n,"/courses")).then((function(e){return e.json()})).then((function(t){return e.setState({times:t},(function(){return e.formatTimes()}))})).catch((function(e){return e})),this.calendarComponentRef.current.getApi().gotoDate("2020-06-01")}},{key:"componentDidMount",value:function(){this.displayCalendar()}},{key:"componentDidUpdate",value:function(e){this.props.refreshCalendar&&e.refreshCalendar!=this.props.refreshCalendar&&this.displayCalendar()}}]),t}(n.Component)),O=(a(58),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).selectBuilding=function(e){a.setState({showCalendar:!1}),a.setState({building:e})},a.selectRoom=function(e){a.setState({showCalendar:!1}),a.setState({room:e})},a.showCalendar=function(){a.setState({showCalendar:!0}),a.props.history.push("/".concat(a.state.building,"/").concat(a.state.room))},a.state={building:e.match.params.building,room:e.match.params.room,showCalendar:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"search"},r.a.createElement(y,{className:"queryform",key:"".concat(this.props.match.params.building).concat(this.props.match.params.room),defaultBuilding:this.state.building,defaultRoom:this.state.room,selectBuilding:this.selectBuilding,selectRoom:this.selectRoom,submit:this.showCalendar}),r.a.createElement("div",{className:"calendar"},r.a.createElement(p.a,{path:"/:building/:room",render:function(t){return r.a.createElement(w,Object.assign({key:"".concat(e.props.match.params.building).concat(e.props.match.params.room),refreshCalendar:e.state.showCalendar},t))}})))}},{key:"componentDidUpdate",value:function(e){var t=e.match.params,a=this.props.match.params;a.building==t.building&&a.room==t.room||this.setState({building:this.props.match.params.building,room:this.props.match.params.room})}}]),t}(n.Component)),j=a(21),R=a.n(j),C=a(44),T=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={emptyRooms:[]},a.findEmptyRooms=function(){var e,t,n,r,o,i,s;return R.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=a.props.match.params,t=e.building,e.room,n=[],c.next=4,R.a.awrap(fetch("/api/building/".concat(t,"/rooms")).then((function(e){return e.json()})));case 4:r=c.sent,o=r.length,i=function(e){var a,o,i,s,c,l,u;return R.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,R.a.awrap(fetch("/api/building/".concat(t,"/").concat(r[e],"/courses")).then((function(e){return e.json()})));case 2:a=m.sent,o=new Date,i=o.getDay(),s=o.toLocaleTimeString(navigator.language,{hourCycle:"h24",hour:"2-digit",minute:"2-digit"}),c="",1===i?c="M":2===i&&(c="T(?!h)"),3===i&&(c="W"),4===i&&(c="Th"),5===i&&(c="F"),(l=a.filter((function(e){return e.weekdays.match(new RegExp(c))})).sort((function(e,t){return e.start_time>t.start_time?1:t.start_time>e.start_time?-1:0})).reduce((function(e,t){return 0!=e.length&&e[e.length-1].start_time==t.start_time||e.push(t),e}),[])).find((function(e){return e.start_time<=s&&e.end_time>s}))||(u=l.find((function(e){return e.start_time>s})),n.push({room:r[e],time:u?u.start_time:u}));case 13:case"end":return m.stop()}}))},s=0;case 8:if(!(s<o)){c.next=14;break}return c.next=11,R.a.awrap(i(s));case 11:++s,c.next=8;break;case 14:a.setState({emptyRooms:n});case 15:case"end":return c.stop()}}))},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(C.a,{className:this.props.className},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Room"),r.a.createElement("th",null,"Available Until"))),r.a.createElement("tbody",null,this.state.emptyRooms.map((function(e){return r.a.createElement("tr",{key:e.room},r.a.createElement("td",null,e.room),r.a.createElement("td",null,"Available until ",e.time||"closing"))}))))}},{key:"componentDidMount",value:function(){this.findEmptyRooms()}},{key:"componentDidUpdate",value:function(e){this.props.refreshTable&&e.refreshTable!=this.props.refreshTable&&this.findEmptyRooms()}}]),t}(n.Component),S=(a(63),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).selectBuilding=function(e){a.setState({showNearby:!1}),a.setState({building:e})},a.selectRoom=function(e){a.setState({showNearby:!1}),a.setState({room:e})},a.showAvailabilityTable=function(){a.setState({showNearby:!0}),a.props.history.push("/nearby/".concat(a.state.building,"/").concat(a.state.room))},a.state={building:e.match.params.building,room:e.match.params.room,emptyRooms:[],showNearby:!1},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"nearby"},r.a.createElement(y,{className:"queryform",key:"".concat(this.props.match.params.building).concat(this.props.match.params.room),defaultBuilding:this.state.building,defaultRoom:this.state.room,selectBuilding:this.selectBuilding,selectRoom:this.selectRoom,submit:this.showAvailabilityTable,buttonText:"Find Nearby"}),r.a.createElement("div",{className:"results"},r.a.createElement(p.a,{path:"/nearby/:building/:room",render:function(t){return r.a.createElement(T,Object.assign({key:"".concat(e.props.match.params.building).concat(e.props.match.params.room),refreshTable:e.state.showNearby},t))}})))}},{key:"componentDidUpdate",value:function(e){var t=e.match.params,a=this.props.match.params;a.building==t.building&&a.room==t.room||this.setState({building:this.props.match.params.building,room:this.props.match.params.room})}}]),t}(n.Component)),N=(a(64),function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(d.a,{bg:"light",variant:"light"},r.a.createElement(f.a,{className:"mr-auto"},r.a.createElement(f.a.Link,{href:"/"},"Search Any Room"),r.a.createElement(f.a.Link,{href:"/nearby"},"Find Open Rooms Nearby"))),r.a.createElement(p.c,null,r.a.createElement(p.a,{path:"/nearby/:building/:room",component:S}),r.a.createElement(p.a,{exact:!0,path:"/nearby",component:S}),r.a.createElement(p.a,{path:"/:building/:room",component:O}),r.a.createElement(p.a,{exact:!0,path:"/",component:O})))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(65);i.a.render(r.a.createElement(s.a,null,r.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[46,1,2]]]);
//# sourceMappingURL=main.3c8db786.chunk.js.map